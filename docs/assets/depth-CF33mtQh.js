(function(){"use strict";function c(f,r,s){return f.forEach(i=>{let l=[+i[0],+i[1]],o=0,u=r[s].length-1;for(;o<=u;){const n=Math.floor((o+u)/2);if(l[0]===+r[s][n][0]){l[1]?r[s][n]=l:r[s].splice(n,1);break}if(l[1]){if(n===0&&l[0]<+r[s][n][0]){r[s].unshift(l);break}else if(n===r[s].length-1&&l[0]>+r[s][n][0]){r[s].push(l);break}}else break;+r[s][n][0]<l[0]?u=n-1:o=n+1}}),r}function k(f,r){return f[r]=f[r].map((s,i)=>(s[3]=+s[0]*+s[1],i===0?(s[2]=+s[1],s):(s[2]=+s[1]+f[r][i-1][2],s))),r==="asks"&&f.asks.reverse(),f}onmessage=f=>{const r=JSON.parse(f.data[1]);let s=f.data[0];c(r.a,s,"asks"),c(r.b,s,"bids"),k(s,"asks"),k(s,"bids"),postMessage(s)}})();
